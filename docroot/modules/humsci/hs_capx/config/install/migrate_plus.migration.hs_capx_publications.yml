uuid: eac63676-c6b7-4251-a669-ca6347d8a0a9
langcode: en
status: false
dependencies: {
  config:
    - node.type.hs_publications
    - migrate_plus.migration_group.hs_capx
}
id: hs_capx_publications
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: {  }
migration_group: hs_capx
label: 'H&S CAPx Publications Importer'
source:
  plugin: url
  data_parser_plugin: jsonpath
  constants:
    status: 1
    type: hs_publications
    minimal_html: minimal_html
    publication_link_title: 'Publication Link'
  urls: { }
  item_selector: $..publications[*]
  fields:
    -
      name: publication_id
      label: 'Publication ID'
      selector: publicationId
    -
      name: title
      label: 'Title'
      selector: title
    -
      name: first_published
      label: 'First Published'
      selector: firstPublished.value
    -
      name: publication_type
      label: 'Publication Type'
      selector: type
    -
      name: apa_citation
      label: 'APA Citation'
      selector: apaCitation
    -
      name: doi_url
      label: 'DOI URL'
      selector: doiUrl
    -
      name: ws_url
      label: 'Web of Science URL'
      selector: webOfScienceUrl
    # -
    #   name: sunetid
    #   label: sunetid
    #   selector: ../uid
    # -
    #   name: profile_id
    #   label: 'Profile ID'
    #   selector: ../profileId
  ids:
    publication_id:
      type: string
process:
  type: constants/type
  status: constants/status
  title:
    -
      plugin: substr
      start: 0
      length: 255
      source: title
  field_hs_publication_year:
    -
      plugin: skip_on_empty
      method: process
      source: first_published
    -
      plugin: substr
      start: 0
      length: 10
  field_hs_publication_type:
    -
      plugin: skip_on_empty
      method: process
      source: publication_type
    -
      plugin: entity_generate
      entity_type: taxonomy_term
      bundle_key: vid
      bundle: hs_publication_type
      value_key: name
      ignore_case: true
  field_hs_publication_citation/value: apa_citation
  field_hs_publication_citation/format: constants/minimal_html
  # publication_uri:
  #   -
  #     plugin: null_coalesce
  #     source:
  #       - doi_url
  #       - ws_url
  # field_hs_publication_link/uri:
  #   -
  #     plugin: skip_on_empty
  #     method: process
  #     source: '@publication_uri'
  field_hs_publication_link/title: constants/publication_link_title
  # field_hs_publication_author: author
destination:
  plugin: 'entity_reference_revisions:node'
  new_revisions: true
  force_revision: true
  overwrite_properties:
    - title
    # - revision_timestamp
    # - revision_translation_affected
    - type
    - field_hs_publication_year
    - field_hs_publication_type
    - field_hs_publication_citation
    - field_hs_publication_link
    # - field_hs_publication_author
migration_dependencies:
  required: {  }
