uuid: accb1872-4298-4ae3-b66e-774497d16555
langcode: en
status: true
dependencies: {  }
_core:
  default_config_hash: 2DJ5AzPeTfHylbydpZgbiPH85AJUWuiotQgawcg3SU8
id: hs_courses
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: null
migration_group: hs_courses
label: 'Course importer'
source:
  track_changes: true
  plugin: url
  data_fetcher_plugin: http
  urls: 'http://archaeology.suhumsci.loc/api/hs_courses'
  data_parser_plugin: json
  item_selector: /
  fields:
    -
      name: guid
      label: GUID
      selector: guid
    -
      name: title
      label: 'Course Title'
      selector: title
    -
      name: description
      label: Description
      selector: description
    -
      name: year
      label: 'Course Academic Year'
      selector: year
    -
      name: component
      label: 'Section Component'
      selector: section/component
    -
      name: course_id
      label: 'Course ID'
      selector: administrativeInformation/courseId
    -
      name: code
      label: 'Section Code'
      selector: code
    -
      name: grading
      label: 'Course Grading'
      selector: grading
    -
      name: requirements
      label: 'Course Requirements'
      selector: gers
    -
      name: section_id
      label: 'Section ID'
      selector: section/classId
    -
      name: section_number
      label: 'Section Number'
      selector: section/sectionNumber
    -
      name: subject
      label: 'Course Subject'
      selector: subject
    -
      name: units
      label: 'Section Units'
      selector: section/units
    -
      name: tags
      label: 'Course Tags'
      selector: tags
    -
      name: quarter
      label: 'Section Quarter'
      selector: section/term
    -
      name: instructors
      label: Instructors
      selector: 'section/schedule/instructors'
    -
      name: section_location
      label: 'Section Location'
      selector: 'section/schedule/location'
    -
      name: section_days
      label: 'Section Days'
      selector: 'section/schedule/days'
    -
      name: start_date
      label: 'Start Date'
      selector: 'section/schedule/startDate'
    -
      name: end_date
      label: 'End Date'
      selector: 'section/schedule/endDate'
    -
      name: start_time
      label: 'Start Time'
      selector: 'section/schedule/startTime'
    -
      name: end_time
      label: 'End Time'
      selector: 'section/schedule/endTime'
  ids:
    guid:
      type: string
  constants:
    status: 1
    type: hs_course
    basic_html: basic_html
    link: 'http://explorecourses.stanford.edu/search?view=catalog&filter-coursestatus-Active=on&page=0&catalog=&q='
process:
  status: constants/status
  type: constants/type
  title: title
  body/value: description
  body/format: constants/basic_html
  field_hs_course_grading: grading
  field_hs_course_code: code
  field_hs_course_id: course_id
  field_hs_course_requirements: requirements
  field_hs_course_section_id: section_id
  field_hs_course_section_number: section_number
  field_hs_course_subject: subject
  field_hs_course_section_units: units
  field_hs_course_section_location: section_location
  field_hs_course_academic_year:
    -
      plugin: substr
      source: year
      start: 5
    -
      plugin: format_date
      from_format: 'Y'
      to_format: Y-06-01
  field_hs_course_section_comp:
    -
      plugin: entity_generate
      entity_type: taxonomy_term
      bundle_key: vid
      bundle: hs_course_component
      value_key: name
      source: component
    -
      plugin: default_value
      default_value: null
  field_hs_course_tags:
    -
      plugin: sub_process
      source: tags
      key: name
      process:
        target_id:
          -
            plugin: concat
            source:
              - organization
              - name
            delimiter: '::'
          -
            plugin: tanslate_course_tag
          -
            plugin: entity_generate
            entity_type: taxonomy_term
            bundle_key: vid
            bundle: hs_course_tags
            value_key: name
    -
      plugin: flatten
  field_hs_course_section_quarter:
    -
      plugin: skip_on_empty
      method: process
      source: quarter
    -
      plugin: substr
      start: 10
  field_hs_course_link:
    -
      plugin: skip_on_empty
      method: process
      source: subject
    -
      plugin: skip_on_empty
      method: process
      source: code
    -
      plugin: concat
      source:
        - constants/link
        - subject
        - code
  field_hs_course_section_days:
    -
      plugin: skip_on_empty
      method: process
      source: section_days
    -
      plugin: str_replace
      regex: true
      search: '/[\t]/'
      replace: ' '
    -
      plugin: str_replace
      regex: true
      search: '/[\n]/'
      replace: ' '
    -
      plugin: str_replace
      regex: true
      search: '/[[:blank:]]+/'
      replace: ' '
    -
      plugin: callback
      callable: trim

  field_hs_course_section_st_date:
    -
      plugin: skip_on_empty
      method: process
      source: start_date
    -
      plugin: format_date
      from_format: 'M j, Y'
      to_format: Y-m-d
    -
      plugin: default_value
      default_value: null
  field_hs_course_section_end_date:
    -
      plugin: skip_on_empty
      method: process
      source: end_date
    -
      plugin: format_date
      from_format: 'M j, Y'
      to_format: Y-m-d
    -
      plugin: default_value
      default_value: null
  field_hs_course_section_end_time: end_time
  field_hs_course_section_st_time: start_time
  field_hs_course_section_instruc:
    -
      plugin: skip_on_empty
      method: process
      source: instructors
    -
      plugin: sub_process
      key: sunet
      process:
        target_id:
          plugin: entity_generate_no_lookup
          entity_type: course_collections
          bundle_key: type
          bundle: instructor
          value_key: title
          source: name
    -
      plugin: flatten
destination:
  plugin: 'entity:node'
migration_dependencies:
  required: {  }
